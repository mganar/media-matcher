<!DOCTYPE html>
<html>
<head>
    <title>Liked Movies</title>
    <style>
 body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
        }
        .movie-card-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); /* Adjust the minimum and maximum width as needed */
    gap: 20px;
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}
.media-card {
    border: 1px solid #ccc;
    background-color: #fff;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    padding: 20px;
    text-align: center;
    width: 300px; /* Set the desired width for your cards */
    margin: 0 auto; /* Center the cards horizontally */
    max-width: 100%; /* Ensure the cards do not exceed their specified width */
    box-sizing: border-box; /* Include padding and borders in the width calculation */
    font-family: Arial, sans-serif; /* Apply the specified font */
}



        .media-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .media-card img {
            max-width: 100%;
            height: auto;
        }
        .media-card h2 {
            font-size: 18px;
            margin-top: 10px;
            margin-bottom: 5px;
        }
        .media-card p {
            font-size: 14px;
            margin-bottom: 10px;
        }
        .media-card .genres-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .media-card .genres-list li {
            font-size: 12px;
            margin-bottom: 5px;
        }
        .media-card .remove-button {
            background-color: #000000;
            color: #fff;
            border: none;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }
        .media-card .remove-button:hover {
            background-color: #000000;
        }
    </style>
</head>
<body>
    <div class="dropdown">
        <button id="dropdownButton" class="dropbtn">Menu</button>
        <div class="dropdown-content" id="dropdownContent">
            <!-- Add your dropdown menu items here -->
            <a href="home.html">Return to Category Page</a>
            <a href="index.html">Logout</a>
        </div>
    </div>
    
    <h1>Liked Movies</h1>
    <div class="movie-card-container" id="movieCardsContainer"></div>

    <!-- Define a container for liked medias -->
    <div class="liked-media-card"></div>

    <!-- Include any external scripts and dependencies here if needed -->
    <script>
   // Initialize the likedMedias array

   function displayLikedMedias() {
    const likedMediasList = document.querySelector('.liked-media-card');
    likedMediasList.innerHTML = ''; // Clear the list

    likedMedias.forEach((media, index) => {
        const mediaCard = document.createElement('div');
        mediaCard.classList.add('media-card');
        mediaCard.innerHTML = `
            <img src="${media.backdrop_path}" alt="${media.original_title}">
            <h2>${media.original_title}</h2>
            <p>${media.overview}</p>
            <p style="margin-bottom: 20px; font-weight: bold;">Genres</p>
            <ul class="genres-list"></ul>
            <p><strong>Content Type:</strong> ${media.contentType}</p>
            <p><strong>Release Date:</strong> ${media.release_date}</p>
            <button class="remove-button">Remove</button>
        `;

        const removeButton = mediaCard.querySelector(".remove-button");
        removeButton.addEventListener("click", () => {
            removeMedia(index);
        });

        const genresList = mediaCard.querySelector(".genres-list");
        for (const genre of media.genres) {
            const listItem = document.createElement("li");
            listItem.textContent = genre;
            genresList.appendChild(listItem);
        }

        likedMediasList.appendChild(mediaCard);
    });
}



// Call the function to display liked medias when the page loads
fetchLikedMediasData();
displayLikedMedias();

dropdownButton.addEventListener("click", toggleDropdownMenu);

// Function to save the liked medias to local storage

function fetchLikedMediasData() {
fetch('/likedMedias')
    .then(response => response.json())
    .then(data => {
        likedMedias = data
        console.log(likedMedias)
        displayLikedMedias(likedMedias);
    })
    .catch(error => {
        console.error('Error:', error);
    });

}
// Function to remove a liked media

function removeMedia(index) {
console.log(index)
if (index >= 0 && index < likedMedias.length) {
    const likedMediaID = likedMedias[index]._id;
    removeLikedMedia(likedMediaID)
    likedMedias.splice(index, 1); // Remove the media from the likedMedias array
    
    displayLikedMedias(); // Update the displayed liked medias
}
}


function removeLikedMedia(mediaId) {
// You can use JavaScript fetch or another method to make the request
fetch(`/api/removeLikedMedia/${mediaId}`, {
    method: 'DELETE',
})

.then(response => {
    if (response.status === 200) {
        // Update the UI to indicate that the media has been liked
        console.log('Removing liked media'); 
    } else {
        console.error('Error saving liked media');
    }
})
.catch(error => {
    console.error('Network error:', error);
});
}

    </script>
    
</body>
</html>
